1
00:00:00,000 --> 00:00:06,360
My searches for understanding how to integrate different temperature sensors and gadgets into home assistant

2
00:00:06,360 --> 00:00:11,680
I kept coming across the intermittent tech channel and when Alex suggested that we chat with

3
00:00:12,280 --> 00:00:18,800
Quintin are today. I thought it was a great opportunity to really geek out Quintor. Welcome to the self-hosted program

4
00:00:18,800 --> 00:00:21,720
Thank you very much. Thank you for joining us Alex

5
00:00:21,720 --> 00:00:25,680
And I are both impressed with the amount of output that you have on your channel

6
00:00:25,680 --> 00:00:31,360
But also the depth of detail that you seem to go into like project after project you must

7
00:00:31,800 --> 00:00:33,800
You must put a lot of work into that

8
00:00:34,160 --> 00:00:37,200
Yeah, it's it takes up a lot of my free time

9
00:00:37,200 --> 00:00:42,600
But I'm I guess I geek you would call it by heart and I like finding

10
00:00:43,320 --> 00:00:48,200
Going to the bottom of things and then trying to explain it to others so they can do it also

11
00:00:48,920 --> 00:00:50,720
Well, I appreciate that

12
00:00:50,720 --> 00:00:56,720
Well, it's kind of the ground basis why it started as a blog and then it transitioned into a YouTube channel

13
00:00:56,720 --> 00:01:02,440
So yeah, there are some things that just don't translate into text, huh? Yeah, very true

14
00:01:02,440 --> 00:01:04,960
and and the other way around too, so like

15
00:01:06,200 --> 00:01:10,560
Heaps of code do better on a blog. So now I do kind of both. I

16
00:01:12,160 --> 00:01:16,520
Appreciate that because I agree completely with that and Alex has been striking a good balance with that himself

17
00:01:16,520 --> 00:01:22,800
So Alex was at the recent home server series that put quindor on your radar this time. It was yeah, so

18
00:01:23,400 --> 00:01:30,300
You've been building a server lately. Haven't you with ZFS and doing some stuff with Ryzen and Proxmox and all that kind of stuff

19
00:01:30,480 --> 00:01:34,780
Yeah, my my old server was about six years old now

20
00:01:34,780 --> 00:01:40,360
I think and there were some disks starting to fail and I started to have some other problems and

21
00:01:40,680 --> 00:01:46,240
One of the ways we noticed that is I actually run demotics and home assistant still at both

22
00:01:46,240 --> 00:01:52,040
And well at some point the lights didn't turn on because a disk was crashing stuff like that

23
00:01:52,040 --> 00:01:54,760
So I thought okay time to build a new one

24
00:01:54,760 --> 00:01:59,800
That's the side of self-hosting people don't talk about very often is when it breaks. It's your fault. You got to fix it

25
00:01:59,800 --> 00:02:01,800
Sometimes it's an opportunity

26
00:02:02,200 --> 00:02:09,600
Yeah, so this server looks really sweet. It's a hundred terabyte 10 gigabit server that that's the that's the branding on all of all

27
00:02:09,600 --> 00:02:13,240
Of your videos. How did you come to some of the decisions around?

28
00:02:13,240 --> 00:02:20,100
Choosing the hardware and and and Proxmox and stuff like that for me. The server is kind of

29
00:02:20,920 --> 00:02:26,160
Multi-purpose. I have my youtube channel as we just mentioned and for that I need a lot of storage

30
00:02:26,160 --> 00:02:30,300
I generate about six to eight terabytes of footage raw footage a year

31
00:02:31,320 --> 00:02:37,440
and I also like to live edit from the server, but my old server wasn't really up to that and

32
00:02:37,440 --> 00:02:44,760
Next to that. I run my home animation VMs like with demotics and home assistant from it and for work

33
00:02:44,760 --> 00:02:48,920
I also run some testing environments and things like that. So I

34
00:02:49,640 --> 00:02:51,640
kind of wanted to renew it and

35
00:02:52,000 --> 00:02:54,880
more cores is more better in that regard and

36
00:02:55,620 --> 00:02:56,980
the new

37
00:02:56,980 --> 00:02:59,100
Ryzen 3000 series was launching

38
00:02:59,840 --> 00:03:04,100
So I was like, okay, let's move my old Ryzen

39
00:03:04,100 --> 00:03:09,980
a 1700 desktop to my server platform and then buy a new Ryzen

40
00:03:10,140 --> 00:03:16,220
3000 series and basically buy a new desktop but get a new server out of it. Now have you found the Ryzen switch because

41
00:03:16,700 --> 00:03:18,580
Intel these days

42
00:03:18,580 --> 00:03:24,140
I don't know if you've seen the the latest videos from like Jay's two cents and Linus tech tips and all that

43
00:03:24,140 --> 00:03:31,380
But they are beating up hard on Intel these days. Yeah, well this sort kind of started during the Ryzen 1000 series

44
00:03:31,380 --> 00:03:36,700
So as I said, I was one of the first guys to get it and I did a whole series called the road to Ryzen

45
00:03:37,580 --> 00:03:42,240
Getting the first eight core where I came from a quad core and Intel

46
00:03:42,500 --> 00:03:48,000
well, they quickly followed with six and eight cores, but now I have a 12 core and

47
00:03:49,300 --> 00:03:53,180
Intel basically has nothing that can compete with it even

48
00:03:53,820 --> 00:03:55,940
In the areas where they used to be better

49
00:03:55,940 --> 00:04:03,100
So in IPC and power usage and stuff like that the right especially the Ryzen 3000 series is just better

50
00:04:03,860 --> 00:04:10,540
Yeah, I'm curious specifically which workloads you see a big improvement on is it encoding work? What types of?

51
00:04:11,340 --> 00:04:16,940
CPU loads are you using that benefit? Well take my video rendering from the Intel box

52
00:04:16,940 --> 00:04:23,260
I had before and granted it was a few years old that basically became four times as fast. That's wonderful

53
00:04:23,260 --> 00:04:30,700
we have from a four and a half gigahertz quad core to it basically a four and a half gigahertz with higher IPC 12 core and

54
00:04:31,420 --> 00:04:35,780
the CPU was about the same during that era in price and

55
00:04:37,060 --> 00:04:39,740
From the server. That's now an eight core server

56
00:04:39,740 --> 00:04:46,820
Well, like five years ago that would have been ultra high-end and now it's just like it's eight cores. It's okay

57
00:04:46,820 --> 00:04:52,660
It's something isn't it and you said something in there that piqued my interest because it's something we've attempted

58
00:04:53,300 --> 00:04:59,820
To various degrees of success your live editing over that 10 gigabit connection. You've built on that server

59
00:05:00,500 --> 00:05:05,680
How is that and had did you have to do any particular tweaking to your network your switches in general your network card?

60
00:05:05,780 --> 00:05:09,100
Configuration to make that work. Well, it started in the design of the server

61
00:05:09,940 --> 00:05:14,100
Reusing a desktop platform, but wanting to have high bandwidth

62
00:05:14,100 --> 00:05:17,100
Capabilities you need to take a lot into account

63
00:05:17,580 --> 00:05:22,500
So for instance a desktop platform is mostly limited in regards to PCIe bandwidth

64
00:05:22,700 --> 00:05:29,000
so I did some research and made some videos about that and how to look up how many PCIe lanes there are and your

65
00:05:29,000 --> 00:05:35,960
Motherboard and how they're distributed and then how you should basically distribute your cards over the available PCI slots

66
00:05:35,960 --> 00:05:37,960
so that there won't be a bottleneck there and

67
00:05:37,960 --> 00:05:43,280
After that, I run Proxmox with ZFS under it

68
00:05:43,280 --> 00:05:49,240
And I did a little bit of tuning in regards to flash based caching in ZFS

69
00:05:49,560 --> 00:05:54,000
So basically on the server the the project I'm editing

70
00:05:54,640 --> 00:06:01,540
After a little while, especially from ingesting footage is basically all on the cache drive, which is an NVMe drive

71
00:06:01,840 --> 00:06:05,640
so I can basically edit at full 10 gig speeds and

72
00:06:05,640 --> 00:06:12,040
although that's still slower than locally, especially the latency that it doesn't come from a hard disk and

73
00:06:12,400 --> 00:06:18,840
Well one gigabyte a second. That's plenty fast to edit video. I gotta say you're making me want to try it again

74
00:06:18,840 --> 00:06:24,520
That's great. And then the storage is taken care of you're investing your money in one place

75
00:06:24,520 --> 00:06:28,040
You have you can you can focus your performance on the server. That's really clever

76
00:06:28,120 --> 00:06:32,520
Yeah, but also things around it like backup scripts and stuff like that

77
00:06:32,520 --> 00:06:37,440
We're all kind of lax in setting that up on our desktop or workstation and stuff like that

78
00:06:37,560 --> 00:06:43,080
But on my server, I basically have directories where everything goes. So I have some scripts running which make

79
00:06:43,800 --> 00:06:49,480
backups to my as I call a DIY cloud backup solution, which I set up a few years ago and

80
00:06:50,080 --> 00:06:54,920
That always runs that just runs during the night when my desktop is off, but my server is on

81
00:06:54,920 --> 00:06:58,720
So I know if my stuff is on there, it's good

82
00:06:58,720 --> 00:07:05,960
Because using ZFS you have the advantage of stuff like data sets and do you do make use of anything like ZFS send

83
00:07:05,960 --> 00:07:10,200
For remote backups or like how do you do you even worry about off-site backups?

84
00:07:10,200 --> 00:07:15,960
Yeah, I don't make bad use of ZFS send or receive but I do off-site backups using a

85
00:07:16,520 --> 00:07:20,120
Basically a DIY cloud backup solution. I built a few years ago

86
00:07:20,120 --> 00:07:28,600
Um, do you guys remember a backup service called crash plan? Oh, yeah with a horrible Java client and everything. Yep. Wonderful

87
00:07:30,080 --> 00:07:37,880
Okay, granted, but they were the first to offer online backups with an unlimited plan basically for like a few bucks a month

88
00:07:38,160 --> 00:07:44,140
So I've been using that for a few years and it was great and they allowed you to back up 10 PCs

89
00:07:44,140 --> 00:07:50,560
So I backed up my mother's and father's PC and my sister's and mine and my laptop and some VMs

90
00:07:50,560 --> 00:07:54,800
I had and that was all fine. And then they announced well, we're stopping and

91
00:07:55,400 --> 00:07:57,400
a lot of other

92
00:07:57,520 --> 00:08:01,360
Cloud hosted backup solutions out there. They're limited to

93
00:08:02,280 --> 00:08:07,640
One client only so let's say you have black place and you have their unlimited plan

94
00:08:07,640 --> 00:08:14,440
They limit you to have only a single client, but I have like eight or ten clients which have all my data

95
00:08:14,880 --> 00:08:21,080
naturally, so I basically got together with a few friends and my parents home just got

96
00:08:21,440 --> 00:08:23,200
500

97
00:08:23,200 --> 00:08:25,200
Symmetrical megabits fiber

98
00:08:25,280 --> 00:08:30,440
so we basically chipped in got five ten terabyte hard disks and I set up a

99
00:08:30,920 --> 00:08:34,880
s3 server on their LAN which we could access remotely and

100
00:08:34,880 --> 00:08:41,440
Ever since I've been backing up to that because it turns out if you buy five times ten terabytes with

101
00:08:41,660 --> 00:08:45,600
Like an atom based server and run minio for s3

102
00:08:45,960 --> 00:08:52,280
you can use all kinds of backup tools out there which talk as s3 and currently using RESTIC and

103
00:08:53,600 --> 00:08:56,920
Back up anything you want to that and if you share that with a few friends

104
00:08:56,920 --> 00:09:01,180
It's even a lot cheaper than the cloud if you take in if you look at it for like five years

105
00:09:01,180 --> 00:09:05,900
Absolutely, I love that you chose to essentially implement

106
00:09:06,740 --> 00:09:11,060
Self-hosted s3 services simply because of the client compatibility. That's probably a similar direction

107
00:09:11,060 --> 00:09:14,940
I would have considered going because you're right you get so many good backup clients now and

108
00:09:16,420 --> 00:09:21,640
Yeah, even if even if once a year around, you know, like an annual sale

109
00:09:22,340 --> 00:09:27,380
Everybody goes in and you buy one more hard drive or two more hard drives to add to the mix or whatever your whatever your plan

110
00:09:27,380 --> 00:09:33,260
Is have you thought about that long term? Like will you just continue to add this at an add to at a time or what?

111
00:09:33,260 --> 00:09:36,260
Your thoughts around long term five years like you were saying

112
00:09:36,860 --> 00:09:37,940
well

113
00:09:37,940 --> 00:09:39,940
Since I went to ZFS route

114
00:09:40,940 --> 00:09:45,500
Expandability isn't really a thing yet. So we went with five times ten terabyte

115
00:09:45,740 --> 00:09:52,780
Which would basically be enough for the people involved for those five years and just don't even have to worry about it then no

116
00:09:52,780 --> 00:09:56,520
No, that's gonna be fine for a few years

117
00:09:57,140 --> 00:10:00,220
That is fantastic. Well going back to your new server

118
00:10:00,220 --> 00:10:04,380
I don't want to spoil it because it's a series of videos and there's a lot of details in there

119
00:10:04,580 --> 00:10:08,660
but something that Alex mentioned to me that I I wanted to sort of

120
00:10:09,060 --> 00:10:14,040
Not only get you to chat about here on the show, but it kind of is a great example of your attention detail

121
00:10:14,560 --> 00:10:20,820
You spend some time in this home server build specifically paying attention to the PCI Lane setup

122
00:10:20,820 --> 00:10:24,200
I'm not really familiar with that part of the series. So could you fill me in on those details?

123
00:10:24,700 --> 00:10:27,380
Basically if you're using a desktop platform

124
00:10:28,100 --> 00:10:32,740
those are basically geared towards having you have everything on board and

125
00:10:33,220 --> 00:10:37,560
Then having a graphics card and nowadays, maybe an NVMe SSD

126
00:10:37,900 --> 00:10:45,040
So the PCI lanes so it's what is particularly is it just more more of them and more performance on the desktop boards versus a server

127
00:10:45,040 --> 00:10:47,040
board have you heard of the

128
00:10:47,040 --> 00:10:55,000
The eight times or 16 times graphics card situations like when you're plugging a graphics card in it says I'm running at eight times speed

129
00:10:55,000 --> 00:10:57,480
Or 16 times speed or whatever. Sure

130
00:10:57,480 --> 00:11:05,280
okay, and those refer to the number of PCIe lanes that are available for bandwidth between that device and the CPU one of the

131
00:11:05,280 --> 00:11:07,600
nice things about Threadripper is that it has

132
00:11:08,080 --> 00:11:13,700
Like I forget the exact number but it has like 30 or it might even be 60 PCIe lanes

133
00:11:13,700 --> 00:11:20,620
Yeah, Threadripper has 64 and the newer generation that launched this year actually has 72. Holy crap

134
00:11:20,860 --> 00:11:25,720
So like an NVMe SSD will will generally have a an x4

135
00:11:26,420 --> 00:11:29,020
Slot so that will use four of your PCIe lanes

136
00:11:29,020 --> 00:11:32,480
Which is why it's so fast because it's basically plugged directly into the matrix

137
00:11:33,060 --> 00:11:36,240
When when you're looking at a desktop platform like Andreas says

138
00:11:36,820 --> 00:11:41,980
One of the ways they save money is by not including so many PCIe lanes in the chipsets

139
00:11:41,980 --> 00:11:44,820
if you do want to use your desktop chipset and

140
00:11:45,540 --> 00:11:52,040
Platform for a server and you want to hook up 24 drives and some NVMe cache and have 10 gigabit

141
00:11:52,220 --> 00:11:57,160
You kind of need to take that into account because just plugging all those cards into your motherboard

142
00:11:57,700 --> 00:12:02,680
It might work, but it'll be very limited in regards to bandwidth

143
00:12:02,900 --> 00:12:09,500
You're able to get so in my case if I plug in my graphics cards even into a times one slot

144
00:12:09,500 --> 00:12:15,980
My times four slot will get limited to times two instead of times four PCIe lanes

145
00:12:15,980 --> 00:12:21,980
and that means I can only get about five six gigabit over my ten giga leg instead of getting ten and

146
00:12:23,140 --> 00:12:26,380
That's of course easily testable using network performance tools

147
00:12:26,580 --> 00:12:30,360
But if this happens to your HBA which is hooked up to your hard disks

148
00:12:30,740 --> 00:12:37,040
You'll be scratching behind your ears like why isn't this performing the way I thought it would but yeah

149
00:12:37,040 --> 00:12:40,800
Okay, because Ryzen needs a graphics card, right?

150
00:12:40,800 --> 00:12:47,440
It doesn't have a built-in GPU of any any description like the Intel chips might so one of the one of the videos

151
00:12:47,960 --> 00:12:49,840
Andreas shows he literally

152
00:12:49,840 --> 00:12:56,360
has a GPU that's just garbage just for installing the OS and then he pulls it out and he shows the difference between

153
00:12:56,920 --> 00:13:00,000
his network card running at 6 giga second on a

154
00:13:00,720 --> 00:13:04,720
X 2 or X 4 link and then pulls it out

155
00:13:04,720 --> 00:13:09,320
And then suddenly the extra PCIe lanes are available and he gets the full 10 gig speed

156
00:13:09,320 --> 00:13:12,680
It's actually pretty interesting to watch that is fascinating

157
00:13:12,680 --> 00:13:16,720
I love that you took the time to actually demonstrate that to you. That's that's great

158
00:13:16,720 --> 00:13:22,600
As you said, I think it's the details that the bigger youtubers they might build something cool

159
00:13:22,600 --> 00:13:25,980
But they don't really have time to work that in the videos

160
00:13:26,000 --> 00:13:31,420
So I thought like okay, let's do a whole series about this so that people want to do the same

161
00:13:31,420 --> 00:13:35,060
Actually know what to take into account because what's your background?

162
00:13:36,060 --> 00:13:41,280
I've picked up in some of the some of the episodes that you might have an enterprise you storage you type background

163
00:13:41,280 --> 00:13:46,900
I'm just curious. I've been doing enterprise storage and mainly backup focused storage

164
00:13:47,500 --> 00:13:50,880
And and backup solutions for the past 20 years now

165
00:13:51,420 --> 00:13:53,900
In the bigger enterprise situation

166
00:13:53,900 --> 00:13:59,220
So if you have like five and a terabyte or even a few petabyte and you want a storage solution for that or a backup

167
00:13:59,220 --> 00:14:04,480
Solution and basically you're a guy. So what what we're doing at home is is kind of cute to you, I guess

168
00:14:05,260 --> 00:14:07,260
in some ways, but it also

169
00:14:08,140 --> 00:14:11,940
Teaches me a lot of stuff. So it's it's a win-win for that for both

170
00:14:12,500 --> 00:14:14,820
Both sides basically and how do you square off?

171
00:14:14,820 --> 00:14:20,000
You know because in the enterprise everything's about being highly available which will lead into another topic shortly

172
00:14:20,860 --> 00:14:24,100
You know, how do you square off desktop hardware of you know?

173
00:14:24,100 --> 00:14:30,960
Having a single power supply only and stuff like that against that kind of enterprise. Let's have redundant everything

174
00:14:31,140 --> 00:14:33,140
so in the enterprise

175
00:14:33,900 --> 00:14:35,740
Time is basically money

176
00:14:35,740 --> 00:14:40,860
So if you can spend more money to not have downtime basically

177
00:14:41,180 --> 00:14:46,060
That's most often worth it. So having a dual PSU which will cost you

178
00:14:47,020 --> 00:14:50,620
$600 instead of having a single one which will cost you $200

179
00:14:50,620 --> 00:14:54,840
But being down one hour costs you $2,000

180
00:14:55,420 --> 00:14:57,420
Well that choice is easy

181
00:14:57,460 --> 00:14:59,460
Mm-hmm, but at home

182
00:15:00,260 --> 00:15:02,260
$2,000 for like oh, sorry

183
00:15:02,260 --> 00:15:07,740
$600 for like a dual power supply is a lot of money where two hundred dollars will work fine

184
00:15:07,800 --> 00:15:10,820
Except indeed if it fails, but then if it fails

185
00:15:10,820 --> 00:15:18,440
I'll just run out get a different power supply plug it in and I've been down maybe a day and during that day

186
00:15:18,440 --> 00:15:22,800
And well not two thousand dollars per 24 per hour were lost

187
00:15:24,000 --> 00:15:25,960
So I can't really

188
00:15:25,960 --> 00:15:31,280
Make the same judgment call. So my time is worth less money than it is in the enterprise

189
00:15:31,320 --> 00:15:35,800
Yeah, it's a good rationale and I can't argue with it, you know

190
00:15:35,840 --> 00:15:41,840
But one thing that has come up in your latest video is a highly available home assistant

191
00:15:41,840 --> 00:15:44,000
I am super interested in this

192
00:15:44,000 --> 00:15:50,800
So please talk us through what that is first of all what that means because some people listening to this may not be familiar with what?

193
00:15:50,800 --> 00:15:57,400
Highly available means in the enterprise next to having redundant components on a single server

194
00:15:57,680 --> 00:16:03,120
they also have a term ha or called high availability is that if a

195
00:16:03,520 --> 00:16:05,600
Complete hardware box would go down

196
00:16:06,200 --> 00:16:11,980
basically, there's a cluster of hardware boxes, which then would take over the function or

197
00:16:11,980 --> 00:16:17,580
VMs or guests or whatever that other box was running and then basically started again

198
00:16:17,860 --> 00:16:21,660
To make that service it was running or providing available again

199
00:16:22,060 --> 00:16:27,340
So a really simple example of this in the real world would be if you only have one car

200
00:16:27,460 --> 00:16:32,860
That's a single point of failure in your life, right if your car breaks down and you can't drive it anymore

201
00:16:33,460 --> 00:16:38,620
Suddenly you think to yourself. Well, I should have a backup car. Well, this is what we're talking about in terms of

202
00:16:38,620 --> 00:16:43,540
Site reliability engineering here. It's a bit of a DevOps II type topic

203
00:16:43,540 --> 00:16:47,700
but it's very important in in cloud architectures and that kind of thing as well and

204
00:16:48,220 --> 00:16:53,580
I don't see any reason why we can't start implementing some of this stuff in our home setups

205
00:16:53,580 --> 00:16:55,580
I home assistant and stuff like that when you're running

206
00:16:56,500 --> 00:17:00,780
Services in your house that you rely on to control your lighting your heating etc, etc

207
00:17:02,020 --> 00:17:04,380
having home assistant able to be able to

208
00:17:04,380 --> 00:17:09,900
Move between a Raspberry Pi and your server and a NUC under the stairs, you know

209
00:17:09,900 --> 00:17:14,580
So you've got two or three different devices that are capable of running that setup. You might have one

210
00:17:14,580 --> 00:17:19,660
That's your primary beefy, you know your best car or whatever to get back to that analogy

211
00:17:20,140 --> 00:17:23,300
But you might have your backup car that might be a bit old and a bit rusty

212
00:17:23,300 --> 00:17:28,860
But it will get the job done in a in a pinch. Yeah, that's that's exactly as I've well

213
00:17:28,860 --> 00:17:33,260
I'm still trying to build this or looking into it, but that's basically what I have

214
00:17:33,260 --> 00:17:40,460
I have the the beefy new server, but the old server has become one of the nodes in a Proxmox cluster and

215
00:17:41,500 --> 00:17:48,980
It certainly can't do everything the new server can but if if the new server would fail for whatever reason I am

216
00:17:49,500 --> 00:17:56,580
Well, we'll go into it deeper, but you can basically start the home assistant VM again on one of the lesser power machines

217
00:17:56,580 --> 00:18:01,300
So you won't get all functionality maybe but you'll get the functionality you need

218
00:18:01,300 --> 00:18:07,380
So what what considerations do you have to make with home assistant when you're trying to run it in two places at once?

219
00:18:07,700 --> 00:18:12,780
Effectively, are you are you a has I O user first of all, or do you run it out of a container or an LXC?

220
00:18:12,780 --> 00:18:15,260
or what I've been looking into that and

221
00:18:16,420 --> 00:18:17,340
To start off

222
00:18:17,340 --> 00:18:23,220
I've been a has I O user in a on a Raspberry Pi and then I basically quickly moved into a VM

223
00:18:23,300 --> 00:18:28,180
Because if you want to do something with influx DB and Grafana and stuff like that

224
00:18:28,180 --> 00:18:35,660
The the pie will die a very quiet death. Well the SD card more specifically will will fail very quickly. Yeah. Yes

225
00:18:35,980 --> 00:18:37,980
That's not good news for me

226
00:18:38,780 --> 00:18:41,940
Yeah, cuz I'm feeling all what you're saying right now thinking to myself

227
00:18:42,460 --> 00:18:48,120
Yeah, I really don't want to be troubleshooting a struggling pie at 9 p.m. When I'd rather just sit down on the couch

228
00:18:48,120 --> 00:18:50,120
I can relate to that

229
00:18:50,980 --> 00:18:52,580
You know if you do a lot of this stuff

230
00:18:52,580 --> 00:18:56,780
There's certain times of the day where you just want to be done and when it's something as important as home assistant

231
00:18:56,780 --> 00:18:58,780
This just happened to me recently

232
00:18:58,820 --> 00:19:03,980
Instead of going to bed. I was I was resolving a home assistant issue and I thought to myself for a minute

233
00:19:03,980 --> 00:19:04,780
You know what?

234
00:19:04,780 --> 00:19:10,540
I need to have a way to just switch over to another system or have a snapshot or something. So

235
00:19:11,420 --> 00:19:16,940
it it might sound silly to think about making your home assistant system highly available, but

236
00:19:18,060 --> 00:19:21,100
Listening to the two of you. I think you both make a very compelling argument

237
00:19:21,100 --> 00:19:24,460
It's making me rethink some of my setup even though it's so new which I just hate that

238
00:19:24,460 --> 00:19:29,140
Yeah, that's how it goes but making

239
00:19:30,340 --> 00:19:37,540
Locally run home automation highly available isn't talked about much or at least I don't see a lot of topics about it

240
00:19:37,780 --> 00:19:39,780
but for me, I've just

241
00:19:39,860 --> 00:19:47,340
Encountered this where the box is down because of a hardware issue and I know the VM is on there and I have another box

242
00:19:47,860 --> 00:19:49,860
but I just well

243
00:19:50,180 --> 00:19:52,180
If you don't take any precautions

244
00:19:52,180 --> 00:19:56,140
You're you're done and that's basically what we're talking about here

245
00:19:56,860 --> 00:19:59,820
Making sure that by whatever means possible

246
00:20:00,860 --> 00:20:07,380
The VM if that hardware goes down you can basically start it somewhere else and doesn't even have to be fully automated, right?

247
00:20:07,380 --> 00:20:13,660
Because a lot of stuff in the enterprise has health checks and heartbeats and all that kind of stuff that does automatic failover

248
00:20:14,260 --> 00:20:20,900
But at home, you know this this weekend, for example, I spent a bit of time with has I owe automating snapshots and stuff like that

249
00:20:20,900 --> 00:20:27,140
so I now have the tar files are syncing from my house I owe instance to a

250
00:20:28,180 --> 00:20:29,940
folder on my ZFS

251
00:20:29,940 --> 00:20:32,460
Array, and maybe I could run a house

252
00:20:32,460 --> 00:20:38,060
I ovm on my desktop for a week whilst I wait for a part to come in or something like that using that snapshot

253
00:20:38,060 --> 00:20:40,060
So is that the kind of approach you were taking?

254
00:20:40,900 --> 00:20:45,420
Yes, but a bit more enterprising. I guess you could say so first

255
00:20:45,420 --> 00:20:50,980
I built a four node Proxmox cluster with basically hardware ahead around the house

256
00:20:50,980 --> 00:20:57,140
And even if you just have two boxes instead of one, that's fine. You can build a Proxmox cluster

257
00:20:57,660 --> 00:21:04,500
With that and then the first thing I set up was in Proxmox a few versions back. They introduced

258
00:21:05,140 --> 00:21:06,340
ZFS

259
00:21:06,340 --> 00:21:07,300
replication

260
00:21:07,300 --> 00:21:08,940
so basically

261
00:21:08,940 --> 00:21:12,980
Proxmox will take a snapshot every 15 minutes of your VM and

262
00:21:12,980 --> 00:21:19,140
Send it to the other box and the same VM is over there. It's just turned off. Oh, that's slick

263
00:21:19,140 --> 00:21:24,540
I didn't know you could do that that could turn the recovery time into five minutes. That's really great. I

264
00:21:25,340 --> 00:21:30,040
Want to make sure we chat about something before we go because Alex and I have been getting really into

265
00:21:30,300 --> 00:21:36,100
LED light strips that are controlled by home assistant and you have a really cool DIY project called Quinn LED

266
00:21:36,380 --> 00:21:39,580
I'm not very familiar with it, but it looks like it could be right up our alley

267
00:21:39,580 --> 00:21:44,020
I started this when I started building the house. I'm currently living in I

268
00:21:44,420 --> 00:21:49,620
Wanted to have a dimmer for LED strips and LED lights. It's mainly for LED strips

269
00:21:50,140 --> 00:21:53,580
which I could control using demotics at that time and

270
00:21:54,060 --> 00:21:59,780
I started looking into this and Philips U just became a thing and I started looking into that

271
00:21:59,780 --> 00:22:05,020
I was like, okay, I can do this in my whole house and it's cloud connected and then I have to pay like

272
00:22:05,020 --> 00:22:09,620
$20,000 I was like, that's never gonna happen

273
00:22:11,420 --> 00:22:17,100
How can we do this otherwise and I started looking into this and I basically built the the Quinn LED

274
00:22:17,220 --> 00:22:19,460
OG as I now call it. It was in

275
00:22:20,580 --> 00:22:26,540
2015 I think and I basically designed a PCB in a board with some custom code on an ESP

276
00:22:26,980 --> 00:22:33,740
8266 was an ESP 01 at the time and built a little dimmer board which integrated into demotics

277
00:22:33,740 --> 00:22:39,580
Now fast-forward a few years. I've built more boards. I've built the Quinn LED quad and deca

278
00:22:39,580 --> 00:22:45,460
That's a four channel and ten channel board which I for instance use for all the lighting in my home

279
00:22:45,460 --> 00:22:53,340
But also in my film studio and stuff like that because it's able to do very high PBM frequencies and the newest board

280
00:22:53,340 --> 00:22:56,140
I've released is the Quinn LED dig uno

281
00:22:56,660 --> 00:22:58,660
That's a single channel

282
00:22:58,660 --> 00:23:05,140
Digital LED controller so where analog LEDs can basically only set the strip to a single color

283
00:23:05,740 --> 00:23:07,740
or brightness intensity

284
00:23:09,020 --> 00:23:11,860
Digital LEDs can do this per LED

285
00:23:12,100 --> 00:23:16,100
So you can make all kinds of effects and patterns and all kinds of cool stuff

286
00:23:16,240 --> 00:23:22,340
one thing that I never really considered because the smart LEDs was the first project that got me into

287
00:23:23,020 --> 00:23:25,300
You know, I used to build my own racing drones

288
00:23:25,300 --> 00:23:29,900
I mean I still do but that got me into electronics and soldering and that kind of thing

289
00:23:29,900 --> 00:23:31,900
but the first thing that got me into

290
00:23:32,300 --> 00:23:38,220
Building my own stuff at home was LED lighting and I've got three or four of these things around my house right now

291
00:23:38,220 --> 00:23:40,540
And then I watch your video about this

292
00:23:41,420 --> 00:23:47,060
Dig uno with a fuse in it and polarity protection and all the rest of it and I'm like, oh, yeah

293
00:23:47,060 --> 00:23:49,460
No, I probably should have a fuse in there, shouldn't I?

294
00:23:49,460 --> 00:23:56,260
The Quinn LED dig uno basically was like, okay, I want to do more with digital LEDs around the house and

295
00:23:56,260 --> 00:24:03,460
you can just take an ESP8266 or an Arduino or something like that hook up the pin to the LED strip and

296
00:24:03,460 --> 00:24:05,460
Then you can make the effects

297
00:24:05,460 --> 00:24:09,860
But if you want to install this in somewhat more permanent fashion

298
00:24:10,420 --> 00:24:18,460
You want it like controllable in home assistant and you don't want it to burn down or if you're working it up at 380

299
00:24:18,460 --> 00:24:21,580
Working it up at 3 a.m. And you cross the wires the wrong way

300
00:24:21,900 --> 00:24:27,380
You don't want everything to blow up and that's basically everything I put into the dig uno design

301
00:24:27,380 --> 00:24:29,700
so if a fuse reverse polarity protection

302
00:24:29,700 --> 00:24:37,940
there is a level shifter on there because a ESP sends out 3.3 volts and the LED strip expects 5 volts and

303
00:24:38,420 --> 00:24:41,060
Most of the time it works except when it doesn't

304
00:24:41,780 --> 00:24:45,060
So I kind of incorporated all that into the board

305
00:24:45,060 --> 00:24:52,500
But for people who want to move on from the breadboard with DuPont connections, and if you wiggle it it well turns off

306
00:24:53,260 --> 00:24:55,260
To a bit more permanent setup.

307
00:24:55,260 --> 00:25:01,340
I absolutely love and and thank you for this. I love that you have open-sourced the PCB design

308
00:25:01,340 --> 00:25:03,340
I just think that's so cool.

309
00:25:03,340 --> 00:25:05,580
I basically want it to be available for everyone

310
00:25:05,580 --> 00:25:11,940
I want to talk about two year convert for a few minutes and for those of you that aren't familiar with this wonderful project

311
00:25:11,940 --> 00:25:19,340
There are a bunch of smart plugs that you can buy based around the ESP8266 chip

312
00:25:20,380 --> 00:25:24,860
Tekin in the US makes some and I'm sure Andreas will fill us in on a few

313
00:25:25,380 --> 00:25:29,100
that are available in Europe. These things they try and

314
00:25:30,060 --> 00:25:35,980
Connect back to the the manufacturers data center for some reason to get their firmware updates

315
00:25:35,980 --> 00:25:43,500
And so what two year convert does which there'll be a link in the show notes is it emulates the update server

316
00:25:43,820 --> 00:25:51,260
On a Raspberry Pi or any other device with two NICs what one has to be a Wi-Fi adapter and one has to be an Ethernet

317
00:25:51,980 --> 00:25:57,660
But essentially you turn your Raspberry Pi into the update server of this company

318
00:25:57,660 --> 00:26:03,940
You then flash Tasmota or whatever other firmware you want to onto these devices and then you own them forever

319
00:26:03,940 --> 00:26:09,660
It's really really cool and two year convert is something that you've got into a fair bit, right Andreas?

320
00:26:10,100 --> 00:26:15,820
About a year or one and a half ago a lot of two year based projects like light bulbs and also

321
00:26:16,260 --> 00:26:22,980
Smart metering plugs became available for really interesting prices. These were like 10-15 bucks apiece and

322
00:26:23,540 --> 00:26:29,220
At the time I wanted to measure some stuff in my home for power usage and things like that

323
00:26:29,220 --> 00:26:35,900
And I basically want to have that data in home assistant so it can go to influx and Grafana and you can do all the stuff

324
00:26:35,900 --> 00:26:36,540
with it

325
00:26:36,540 --> 00:26:43,300
But these plugs as you said for some reason have to have an online connection and you can use an app and stuff like that

326
00:26:43,900 --> 00:26:48,180
The hardware is in there. We just want to use it in our own way

327
00:26:48,580 --> 00:26:55,580
But for some reason these manufacturers they don't allow that they they want you to run their firmware and then

328
00:26:55,580 --> 00:27:00,180
And then connect to their data centers and then be allowed to use your data

329
00:27:00,180 --> 00:27:04,580
And I really don't know why it needs to know when I turn on my Christmas lights or not

330
00:27:04,580 --> 00:27:06,220
What are they doing with that data?

331
00:27:06,220 --> 00:27:14,180
I often wonder particularly something that is so random as a switch like what possible information can they have from a switch being on or off?

332
00:27:14,700 --> 00:27:21,340
Presence detection at least at least they know you're there. Do they I mean, I've definitely left my soldering iron on when I'm not home

333
00:27:21,340 --> 00:27:23,660
I

334
00:27:23,660 --> 00:27:25,660
Mean there's such a big community

335
00:27:26,140 --> 00:27:33,100
Basically liberating these kinds of devices with ESP home and Tasmota firmware that I think like okay if even one

336
00:27:33,420 --> 00:27:39,900
manufacturer would just give us the ability to easily do this by hitting a switch in some kind of web interface like

337
00:27:40,420 --> 00:27:45,300
Allow custom third-party binary you take all responsibility click here

338
00:27:45,580 --> 00:27:50,060
It would be an instant hit with the home home automation community, I think but

339
00:27:50,060 --> 00:27:54,140
Nobody does this and is our data worth that much

340
00:27:54,140 --> 00:27:59,180
I mean, I I can't imagine it is and there's so many motivating factors for doing it for myself

341
00:27:59,180 --> 00:28:03,940
I just want it to completely function offline with no internet connection

342
00:28:03,940 --> 00:28:06,820
So when I take the RV somewhere where we have no connectivity

343
00:28:06,820 --> 00:28:11,540
I want everything to remain functional all of my automations to continue to work

344
00:28:11,540 --> 00:28:18,300
I'm not as concerned about the privacy aspect, but that's number two on the list. Those are two pretty strong motivators right there

345
00:28:18,300 --> 00:28:23,740
so I'm already adjusting my buying habits based on what the community seems to be able to

346
00:28:24,660 --> 00:28:30,100
Reflash at different times when I'm purchasing and I'm I know more and more people are doing it and it reminds me of

347
00:28:30,580 --> 00:28:33,460
the battle days with cheap routers

348
00:28:34,700 --> 00:28:36,700
DWRT

349
00:28:37,940 --> 00:28:39,940
Yeah, it's just like that all over again

350
00:28:40,540 --> 00:28:44,000
Only more of them and of different varying quality now

351
00:28:44,000 --> 00:28:51,240
There is a fun Twitter account that I like to follow called the Internet of shit and this talks about how the Internet of things is

352
00:28:52,480 --> 00:28:58,160
It's vulnerable to quite a few things and it isn't always updated and that kind of stuff. It's it's pretty funny

353
00:28:58,160 --> 00:29:01,200
Well and and to Andres's point a little bit more

354
00:29:02,040 --> 00:29:10,080
Why do all of these companies want to be cloud companies with infrastructure and vulnerabilities and services to maintain and API's to update?

355
00:29:10,080 --> 00:29:14,640
Why does a smart plug manufacturer want to even get in that game planned?

356
00:29:15,160 --> 00:29:20,620
Obsolescence Chris you think it is planned. It could be that's the office. That's a little conspiracy bacon Alex

357
00:29:22,040 --> 00:29:25,460
Well, yeah, think about it right if you're a hardware manufacturer and you're selling

358
00:29:26,320 --> 00:29:28,320
it's what's essentially a

359
00:29:29,000 --> 00:29:34,840
one or two dollar circuit board wrapped up in let's say another two or three dollars worth of plastic and

360
00:29:34,840 --> 00:29:40,840
Then you've got to get an FCC rating and all that kind of stuff right there isn't gonna be much money to be made

361
00:29:40,840 --> 00:29:44,760
I wouldn't have thought on a $10 smart plug. The margins are gonna be quite small

362
00:29:45,480 --> 00:29:50,360
so you've got to find some way to get people to buy these things every X number of years and

363
00:29:50,800 --> 00:29:57,040
One fun way to do that is to accidentally I mean air quotes accidentally brick the device

364
00:29:57,120 --> 00:30:00,320
you don't even have to break it you just bring out a new app and

365
00:30:00,320 --> 00:30:06,520
And then the new app can't talk to the old devices, but all the new devices can only talk to the new app

366
00:30:06,960 --> 00:30:14,360
Philips hue hub did yes. Yes, exactly. That's exactly what I have that exact situation because I went into an old

367
00:30:14,840 --> 00:30:19,840
Office that was shutting down and they had old Hughes lights all over the place and I thought well

368
00:30:19,840 --> 00:30:21,840
How great is this and of course?

369
00:30:21,860 --> 00:30:26,520
none of them could be controlled I had to go spelunking for an old app that I

370
00:30:26,520 --> 00:30:30,600
Had I guess had gotten at one point and so I was able to retrieve it

371
00:30:30,600 --> 00:30:32,900
I'm not even know if that normally how it works on the iOS App Store

372
00:30:33,800 --> 00:30:39,560
And then I had to bring it through a generational upgrade process is obnoxious

373
00:30:39,760 --> 00:30:44,780
So, I mean if you can own your hardware, I highly recommend doing it and this two-year convert

374
00:30:46,040 --> 00:30:51,240
Collection of scripts is is really pretty cool. And there's been some updates over this course of this year

375
00:30:51,240 --> 00:30:56,840
Two-year or the two-year compatible device manufacturers patched a lot of the exploits that were being used

376
00:30:57,640 --> 00:31:03,320
And then in September sort of time an update came out and people have found another exploit and that's what we're currently using

377
00:31:03,320 --> 00:31:09,760
So bear in mind this could go away at any time, but a device I bought this week is the Tekin

378
00:31:10,160 --> 00:31:14,960
SS 30 and this thing has four individually controllable

379
00:31:15,640 --> 00:31:17,640
AC ports and four

380
00:31:17,640 --> 00:31:26,920
And four controllable USB ports. So in home assistant, I now have five switches that I can control on one like power strip

381
00:31:27,720 --> 00:31:33,360
Using the the TAS motor firmware and it's really great because I know that that's just going to carry on working now until the end

382
00:31:33,360 --> 00:31:39,420
Of time or until that device physically fails. Wow, that is really great. Is this the one that's only $24 on Amazon?

383
00:31:39,420 --> 00:31:43,200
Yep, believe it or not. I'm gonna drop a link to that in the notes. That's really cool

384
00:31:43,200 --> 00:31:47,480
and all you need to flash it is a Raspberry Pi right and then you own it forever and

385
00:31:48,080 --> 00:31:52,240
They may not make that device forever and or they may patch that vulnerability

386
00:31:52,240 --> 00:31:57,240
but that one now that you own it's good and if you were to buy a couple at a time, you could just kind of set

387
00:31:57,240 --> 00:32:03,880
Up a production chain and just flash a few of them and get it over with and the thing that home assistance enables is now

388
00:32:03,880 --> 00:32:08,120
That you you can use hue and your own flash plugs and all

389
00:32:08,120 --> 00:32:14,360
All kinds of stuff from all kinds of brands and basically connect it all together as long as you can get it into home assistant

390
00:32:14,360 --> 00:32:21,280
And it does that with a lot of cloud enabled stuff too, but getting in it and in there native with Tasmota or ESP home

391
00:32:21,280 --> 00:32:25,280
It's just it makes it work so flawlessly every time

392
00:32:25,960 --> 00:32:27,160
Mm-hmm. Yeah

393
00:32:27,160 --> 00:32:33,320
I really do appreciate that aspect of home assistant because it means that some of these old IOT devices aren't throwaways a

394
00:32:33,320 --> 00:32:38,200
Home assistant doesn't care that these hue bulbs that I got have old firmware on them

395
00:32:38,200 --> 00:32:41,000
It still controls them just fine every now and then they pop offline

396
00:32:41,360 --> 00:32:42,560
It's a little obnoxious

397
00:32:42,560 --> 00:32:49,200
But it's so great at the same time to have three or four different vendors products all controlled locally by one piece of software

398
00:32:49,600 --> 00:32:55,160
But the key thing that I've found is now I shop with home assistant compatibility in mind

399
00:32:55,160 --> 00:33:01,360
That's where I start or a refresh ability for that. But yeah, right? Yep. Yep a good good point

400
00:33:01,360 --> 00:33:05,400
That's another way to look at it. That's basically why I started one of the reasons

401
00:33:05,400 --> 00:33:08,760
I designed my own hardware and dimmers and boards and stuff like that

402
00:33:08,800 --> 00:33:12,920
It's all geared to being controlled with home assistant now

403
00:33:12,920 --> 00:33:15,520
It's an ESP so you can run anything you want on it

404
00:33:15,600 --> 00:33:19,860
But from what I gather and the people in discord and on my website and stuff like that

405
00:33:21,040 --> 00:33:26,840
95% uses it with home assistant. Well Condor. I just want to say thank you again for not only all of the great details

406
00:33:26,840 --> 00:33:34,200
I came across your channel when I was looking for cheap integration thermostats and the home assistant which has made my life more comfortable and

407
00:33:35,000 --> 00:33:37,720
I also just really appreciate the level of details

408
00:33:37,720 --> 00:33:42,840
so we will link to the intermittent tech YouTube channel in the show notes keep up the great work and

409
00:33:43,400 --> 00:33:47,080
Keep us in the loop on future projects and we'd love to chat about them. Sure will do

410
00:33:47,080 --> 00:33:51,880
Thank you for having me. Is there anywhere you would explicitly like to send people? I mean are you on Twitter?

411
00:33:51,880 --> 00:33:54,080
I know you have a discord for example

412
00:33:54,080 --> 00:34:00,960
Um, well people starting with the YouTube channel and if they then want to join the discords the link and stuff are there

413
00:34:01,040 --> 00:34:05,760
So start with the YouTube channel. I think that's a good starting point and you can get more self-hosted show

414
00:34:06,480 --> 00:34:10,320
On Twitter at self-hosted show. I'm on Twitter at ironic badger

415
00:34:10,560 --> 00:34:18,080
I'm at Chris LAS and I'm there under intermittent tech and you can find links to all of those good things in the show notes

416
00:34:18,080 --> 00:34:24,080
at self-hosted.show slash nine

